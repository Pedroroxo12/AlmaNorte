<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Produto - Alma Norte</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="container-fluid">
            <!-- Top header with logo and icons -->
            <div class="row align-items-center py-2" style="border-bottom: 1px solid #ddd;">
                <div class="col-4">
                    <a href="index.html" style="font-family: 'Montserrat', sans-serif; font-size: 14px; font-weight: 600; color: #333; text-decoration: none; letter-spacing: 2px;">ALMANORTE</a>
                </div>
                <div class="col-4 text-center">
                    <a class="navbar-brand" href="http://localhost/AlmaNorte/index.html" style="display:inline-block;">
                        <img src="http://localhost/AlmaNorte/assets/images/Logotipo.png" alt="AlmaNorte" style="height:60px;">
                    </a>
                </div>
                <div class="col-4">
                    <div class="d-flex justify-content-end gap-3">
                        <a href="http://localhost/AlmaNorte/products.html" class="icon-link" style="color: #333; font-size: 18px;"><i class="fas fa-search"></i></a>
                        <a href="account.html" class="icon-link" style="color: #333; font-size: 18px;"><i class="fas fa-user"></i></a>
                        <a href="#" class="icon-link" style="color: #333; font-size: 18px;" data-bs-toggle="offcanvas" data-bs-target="#favoritesOffcanvas"><i class="fas fa-heart"></i></a>
                        <a href="cart.html" class="icon-link" style="color: #333; font-size: 18px;"><i class="fas fa-shopping-cart"></i></a>
                    </div>
                </div>
            </div>
            
            <!-- Navigation menu -->
            <nav class="row align-items-center py-2" style="border-bottom: 1px solid #ddd;">
                <div class="col-12 text-center">
                    <div style="display: flex; justify-content: center; gap: 40px; font-family: 'Montserrat', sans-serif; font-size: 12px; font-weight: 500; letter-spacing: 1px;">
                        <a href="index.html" style="color: #333; text-decoration: none;">HOME</a>
                        <a href="products.html" style="color: #333; text-decoration: none;">PRODUTOS</a>
                        <a href="blog/index.html" style="color: #333; text-decoration: none;">BLOG</a>
                        <a href="producers.html" style="color: #333; text-decoration: none;">PRODUTORES</a>
                        <a href="about/index.html" style="color: #333; text-decoration: none;">SOBRE NÃ“S</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="container my-5" style="padding-top: 80px; padding-bottom: 80px;">
        <!-- Breadcrumb -->
        <div style="margin-bottom: 30px;">
            <p style="font-family: 'Montserrat', sans-serif; font-size: 12px; color: #666; margin: 0;">
                <a href="products.html" style="color: #333; text-decoration: none; font-weight: 500;">Produtos</a> /
            </p>
        </div>
        <div class="row align-items-start">
            <!-- Product Image -->
            <div class="col-md-4">
                <div class="product-image-container" style="border: 1px solid #e0e0e0; padding: 30px; background: white; text-align: center; border-radius: 4px;">
                    <img id="productImage" src="" alt="Product" style="max-width: 100%; height: auto; max-height: 320px; object-fit: contain;">
                </div>
            </div>

            <!-- Product Details -->
            <div class="col-md-8">
                <h1 id="productName" style="font-family: 'Montserrat', sans-serif; font-size: 24px; font-weight: 600; color: #1a1a1a; margin-bottom: 8px; letter-spacing: 0.5px;"></h1>
                <p id="productProducer" style="font-family: 'Montserrat', sans-serif; font-size: 13px; color: #666; margin-bottom: 25px;"></p>
                
                <div style="border-top: 1px solid #e0e0e0; border-bottom: 1px solid #e0e0e0; padding: 15px 0; margin-bottom: 25px;">
                    <h2 id="productPrice" style="font-family: 'Montserrat', sans-serif; font-size: 20px; font-weight: 600; color: #1a1a1a; margin: 0;"></h2>
                </div>

                <p id="productDescription" style="font-family: 'Montserrat', sans-serif; font-size: 12.5px; line-height: 1.7; color: #555; margin-bottom: 30px;"></p>

                <!-- Size Options -->
                <div class="mb-4" id="sizeSection" style="display: none;">
                    <h5 style="font-family: 'Montserrat', sans-serif; font-size: 12px; font-weight: 600; margin-bottom: 12px; text-decoration: underline;">Tamanho</h5>
                    <div class="d-flex gap-2" id="sizeOptions">
                        <button class="size-btn" data-size="250g" style="border: 1px solid #ccc; background: white; padding: 6px 18px; font-family: 'Montserrat', sans-serif; font-size: 11px; cursor: pointer; border-radius: 2px; transition: all 0.2s;">250g</button>
                        <button class="size-btn" data-size="500g" style="border: 1px solid #ccc; background: white; padding: 6px 18px; font-family: 'Montserrat', sans-serif; font-size: 11px; cursor: pointer; border-radius: 2px; transition: all 0.2s;">500g</button>
                        <button class="size-btn" data-size="1kg" style="border: 1px solid #ccc; background: white; padding: 6px 18px; font-family: 'Montserrat', sans-serif; font-size: 11px; cursor: pointer; border-radius: 2px; transition: all 0.2s;">1kg</button>
                    </div>
                </div>

                <!-- Quantity -->
                <div class="mb-4">
                    <h5 style="font-family: 'Montserrat', sans-serif; font-size: 12px; font-weight: 600; margin-bottom: 12px; text-decoration: underline;">Quantidade</h5>
                    <div class="d-flex align-items-center gap-2">
                        <button id="decreaseQty" style="border: 1px solid #ccc; background: white; width: 30px; height: 30px; border-radius: 2px; cursor: pointer; font-size: 16px; color: #333;">-</button>
                        <span id="quantity" style="font-family: 'Montserrat', sans-serif; font-size: 13px; min-width: 25px; text-align: center;">1</span>
                        <button id="increaseQty" style="border: 1px solid #ccc; background: white; width: 30px; height: 30px; border-radius: 2px; cursor: pointer; font-size: 16px; color: #333;">+</button>
                    </div>
                </div>

                <!-- Add to Cart & Favorites -->
                <div class="d-flex gap-2 mb-4">
                    <button id="addToCartBtn" style="flex: 1; background: #8d6e63; color: white; border: none; padding: 10px; font-family: 'Montserrat', sans-serif; font-size: 11px; font-weight: 600; letter-spacing: 0.3px; cursor: pointer; border-radius: 2px; text-transform: uppercase;">Adicionar ao Carrinho</button>
                    <button id="addToFavoritesBtn" style="background: white; border: 1px solid #ccc; padding: 10px 18px; cursor: pointer; border-radius: 2px;">
                        <i class="far fa-heart" style="font-size: 16px; color: #666;"></i>
                    </button>
                </div>

                <!-- Tabs -->
                <div class="product-tabs" style="margin-top: 50px;">
                    <ul class="nav nav-tabs" style="border-bottom: 1px solid #ddd; margin-bottom: 0;">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#about" style="font-family: 'Montserrat', sans-serif; font-size: 12px; font-weight: 500; color: #1a1a1a; border: none; border-bottom: 2px solid #1a1a1a; padding: 12px 20px; background: transparent;">Sobre o Produto</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#history" style="font-family: 'Montserrat', sans-serif; font-size: 12px; font-weight: 500; color: #999; border: none; padding: 12px 20px; background: transparent;">HistÃ³ria</a>
                        </li>
                    </ul>
                    <div class="tab-content" style="padding: 25px 0; border-bottom: 1px solid #e0e0e0;">
                        <div class="tab-pane fade show active" id="about">
                            <p id="productAbout" style="font-family: 'Montserrat', sans-serif; font-size: 12px; line-height: 1.7; color: #555; white-space: pre-line;"></p>
                        </div>
                        <div class="tab-pane fade" id="history">
                            <p id="productHistory" style="font-family: 'Montserrat', sans-serif; font-size: 12px; line-height: 1.7; color: #555; white-space: pre-line;"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommended Products -->
        <div class="recommended-products mt-5" style="padding-top: 30px;">
            <h2 style="font-family: 'Playfair Display', serif; font-size: 28px; font-weight: 400; text-align: center; margin-bottom: 35px; color: #1a1a1a; letter-spacing: 0.5px;">PRODUTOS RECOMENDADOS</h2>
            <div class="row" id="recommendedProducts">
                <!-- Will be populated by JavaScript -->
            </div>
            <div class="text-center mt-4">
                <a href="products.html" style="background: #8d6e63; color: white; padding: 10px 35px; font-family: 'Montserrat', sans-serif; font-size: 11px; font-weight: 600; text-decoration: none; display: inline-block; border-radius: 2px; letter-spacing: 0.3px;">Ver todos os Produtos</a>
            </div>
        </div>
    </main>

    <!-- Favorites Offcanvas -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="favoritesOffcanvas" style="width: 400px;">
        <div class="offcanvas-header" style="background: white; border-bottom: 1px solid #ddd; padding: 20px;">
            <h5 class="offcanvas-title" style="font-family: 'Montserrat', sans-serif; font-size: 14px; font-weight: 600; letter-spacing: 1px; text-transform: uppercase;">FAVORITOS (<span id="favorites-count-offcanvas">0</span>)</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body" style="padding: 0;">
            <div id="favorites-items-offcanvas" style="padding: 20px;">
                <!-- Favorites items will be rendered here -->
            </div>
        </div>
    </div>

    <footer class="footer" style="background-color: #593232 !important;">
        <div class="footer-content">
            <div class="footer-section">
                <h3>APOIO AO CLIENTE</h3>
                <ul class="footer-links">
                    <li><a href="#">Ajuda</a></li>
                    <li><a href="#">Entregas</a></li>
                    <li><a href="#">DevoluÃ§Ãµes</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>INFORMAÃ‡ÃƒO LEGAL</h3>
                <ul class="footer-links">
                    <li><a href="#">PolÃ­tica de Envio</a></li>
                    <li><a href="#">PolÃ­tica de DevoluÃ§Ã£o</a></li>
                    <li><a href="#">Certificados</a></li>
                    <li><a href="#">PolÃ­tica de Privacidade</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>CONTACTE-NOS</h3>
                <p>+351 919 191 919</p>
                <p>almanorte@gmail.com</p>
                <div class="social-links mt-3">
                    <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Copyright Â© 2025 Projeto Web. All right reserved.</p>
            <p><a href="#" style="color: white; text-decoration: underline;">Termos de Uso</a></p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/cart.js"></script>
    <script>
        // Get product data from URL or localStorage
        const urlParams = new URLSearchParams(window.location.search);
        let productId = urlParams.get('id') || 'mel-do-bo';
        
        // Decode URL-encoded parameter
        productId = decodeURIComponent(productId);
        
        // Sample product data (in real app, this would come from a database/API)
        const products = {
            'mel-do-bo': {
                name: 'MEL DO BÓ',
                producer: 'Produtor Rui Lourenço',
                price: '8,95€',
                image: 'assets/images/MEL.jpeg',
                description: 'Mel artesanal produzido em Trás-os-Montes, recolhido de forma sustentável e sem adição de açúcares. Sabor intenso e natural. Ideal para consumo diário ou para acompanhar receitas tradicionais.',
                about: 'O Mel do Bó é um mel artesanal produzido em Trás-os-Montes, obtido a partir do néctar das flores silvestres da região. Apresenta uma textura suave e um sabor equilibrado, com notas naturais que variam consoante a floração da época de colheita.\n\nNão é sujeito a processos industriais nem a aditivos, preservando todas as suas características naturais. Ideal para consumo diário, pode ser utilizado para adoçar bebidas, acompanhar queijos, enriquecer receitas ou simplesmente ser apreciado ao natural.',
                history: 'Não existe descrição de história para este produto.',
                hasSizes: true
            },
            'vinho-trovisco': {
                name: 'VINHO TROVISCO',
                producer: 'Produtor António Barbosa',
                price: '45,95€',
                image: 'assets/images/vinhos.jpeg',
                description: 'Vinho tinto encorpado da região do Douro. Notas frutadas e amadeiradas. Ideal para acompanhar carnes vermelhas e queijos curados.',
                about: 'O Vinho Trovisco é um vinho tinto da região do Douro, produzido a partir de uvas cuidadosamente selecionadas. Apresenta um sabor encorpado com notas frutadas e amadeiradas.',
                history: 'Produzido pela família Barbosa há mais de 3 gerações, este vinho representa a tradição vinícola portuguesa.',
                hasSizes: false
            }
        };

        let currentProduct = products[productId] || products['mel-do-bo'];
        let quantity = 1;
        let selectedSize = '250g';

        // Load product details
        function loadProductDetails() {
            document.getElementById('productName').textContent = currentProduct.name;
            document.getElementById('productProducer').textContent = currentProduct.producer;
            document.getElementById('productPrice').textContent = currentProduct.price;
            document.getElementById('productImage').src = currentProduct.image;
            document.getElementById('productDescription').textContent = currentProduct.description;
            document.getElementById('productAbout').textContent = currentProduct.about;
            document.getElementById('productHistory').textContent = currentProduct.history;
            
            if (currentProduct.hasSizes) {
                document.getElementById('sizeSection').style.display = 'block';
            }
            
            document.title = currentProduct.name + ' - Alma Norte';
        }

        // Quantity controls
        document.getElementById('increaseQty').addEventListener('click', function() {
            quantity++;
            document.getElementById('quantity').textContent = quantity;
        });

        document.getElementById('decreaseQty').addEventListener('click', function() {
            if (quantity > 1) {
                quantity--;
                document.getElementById('quantity').textContent = quantity;
            }
        });

        // Size selection
        document.querySelectorAll('.size-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.size-btn').forEach(b => {
                    b.style.background = 'white';
                    b.style.color = '#333';
                });
                this.style.background = '#8B6F6F';
                this.style.color = 'white';
                selectedSize = this.dataset.size;
            });
        });

        // Add to cart
        document.getElementById('addToCartBtn').addEventListener('click', function() {
            const cartItem = {
                id: productId,
                name: currentProduct.name,
                price: currentProduct.price,
                image: currentProduct.image,
                quantity: quantity,
                size: currentProduct.hasSizes ? selectedSize : null
            };
            
            let cart = JSON.parse(localStorage.getItem('almaNorteCart')) || [];
            
            // Check if item already exists with same size
            const existingIndex = cart.findIndex(item => 
                item.id === cartItem.id && item.size === cartItem.size
            );
            
            if (existingIndex > -1) {
                cart[existingIndex].quantity += quantity;
            } else {
                cart.push(cartItem);
            }
            
            localStorage.setItem('almaNorteCart', JSON.stringify(cart));
            alert('Produto adicionado ao carrinho!');
            
            // Reset quantity
            quantity = 1;
            document.getElementById('quantity').textContent = quantity;
        });

        // Add to favorites
        document.getElementById('addToFavoritesBtn').addEventListener('click', function() {
            const icon = this.querySelector('i');
            if (icon.classList.contains('far')) {
                icon.classList.remove('far');
                icon.classList.add('fas');
                icon.style.color = '#8B6F6F';
                
                // Add to favorites in localStorage
                let favorites = JSON.parse(localStorage.getItem('almaNorteFavorites')) || [];
                favorites.push({
                    id: productId,
                    name: currentProduct.name,
                    price: currentProduct.price,
                    image: 'http://localhost/AlmaNorte/' + currentProduct.image,
                    producer: currentProduct.producer
                });
                localStorage.setItem('almaNorteFavorites', JSON.stringify(favorites));
            } else {
                icon.classList.remove('fas');
                icon.classList.add('far');
                icon.style.color = '#333';
                
                // Remove from favorites
                let favorites = JSON.parse(localStorage.getItem('almaNorteFavorites')) || [];
                favorites = favorites.filter(f => f.id !== productId);
                localStorage.setItem('almaNorteFavorites', JSON.stringify(favorites));
            }
        });

        // Load recommended products
        function loadRecommendedProducts() {
            const recommended = Object.keys(products).filter(id => id !== productId).slice(0, 3);
            const container = document.getElementById('recommendedProducts');
            
            recommended.forEach(id => {
                const product = products[id];
                const col = document.createElement('div');
                col.className = 'col-md-4 mb-4';
                col.innerHTML = `
                    <div style="border: 1px solid #ccc; padding: 25px; text-align: center; border-radius: 4px; cursor: pointer; background: white;" onclick="window.location.href='product-details.html?id=${id}'">
                        <img src="${product.image}" alt="${product.name}" style="max-width: 100%; height: 180px; object-fit: contain; margin-bottom: 15px;">
                        <h5 style="font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 600; margin-bottom: 4px; color: #1a1a1a; letter-spacing: 0.3px;">${product.name}</h5>
                        <p style="font-family: 'Montserrat', sans-serif; font-size: 11px; color: #666; margin-bottom: 8px;">${product.producer}</p>
                        <p style="font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 600; color: #1a1a1a;">${product.price}</p>
                    </div>
                `;
                container.appendChild(col);
            });
        }

        // Tab switching styling
        document.querySelectorAll('.nav-link').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.nav-link').forEach(t => {
                    t.style.color = '#999';
                    t.style.borderBottom = 'none';
                });
                this.style.color = '#1a1a1a';
                this.style.borderBottom = '2px solid #1a1a1a';
            });
        });

        // Initialize
        loadProductDetails();
        loadRecommendedProducts();
        
        // Favorites offcanvas functions
        function renderFavoritesOffcanvas() {
            const favorites = JSON.parse(localStorage.getItem('almaNorteFavorites')) || [];
            const favoritesItemsContainer = document.getElementById('favorites-items-offcanvas');
            const favoritesCountOffcanvas = document.getElementById('favorites-count-offcanvas');
            
            favoritesCountOffcanvas.textContent = favorites.length;
            
            if (favorites.length === 0) {
                favoritesItemsContainer.innerHTML = '<p style="text-align: center; color: #666; font-family: Montserrat, sans-serif; font-size: 14px; padding: 20px;">Sem favoritos</p>';
                return;
            }
            
            let html = '';
            
            favorites.forEach((item, index) => {
                html += `
                    <div style="display: flex; gap: 15px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #eee; position: relative;">
                        <button onclick="removeFromFavorites(${index})" style="position: absolute; top: 0; right: 0; border: none; background: none; color: #666; cursor: pointer; font-size: 18px;">Ã—</button>
                        <img src="${item.image}" alt="${item.name}" style="width: 80px; height: 80px; object-fit: contain; border: 1px solid #e0e0e0; padding: 5px;">
                        <div style="flex: 1;">
                            <h6 style="font-family: 'Montserrat', sans-serif; font-size: 12px; font-weight: 600; margin: 0 0 4px 0; text-transform: uppercase; letter-spacing: 0.5px;">${item.name}</h6>
                            <p style="font-family: 'Montserrat', sans-serif; font-size: 10px; color: #666; margin: 0 0 8px 0;">${item.producer || 'Produtor Rui LorenÃ§o'}</p>
                            <p style="font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 600; margin: 0 0 12px 0;">${item.price}</p>
                            <button onclick="addFavoriteToCart('${item.id}')" style="width: 100%; background: #593232; color: white; border: none; padding: 8px; font-family: 'Montserrat', sans-serif; font-size: 10px; font-weight: 600; text-transform: uppercase; cursor: pointer; letter-spacing: 0.5px;">ADICIONAR AO CARRINHO</button>
                        </div>
                    </div>
                `;
            });
            
            favoritesItemsContainer.innerHTML = html;
        }
        
        function removeFromFavorites(index) {
            let favorites = JSON.parse(localStorage.getItem('almaNorteFavorites')) || [];
            favorites.splice(index, 1);
            localStorage.setItem('almaNorteFavorites', JSON.stringify(favorites));
            renderFavoritesOffcanvas();
        }
        
        function addFavoriteToCart(productId) {
            const favorites = JSON.parse(localStorage.getItem('almaNorteFavorites')) || [];
            const item = favorites.find(fav => fav.id === productId);
            
            if (item) {
                let cart = JSON.parse(localStorage.getItem('almaNorteCart')) || [];
                const existingIndex = cart.findIndex(cartItem => cartItem.id === item.id);
                
                if (existingIndex > -1) {
                    cart[existingIndex].quantity = (cart[existingIndex].quantity || 1) + 1;
                } else {
                    cart.push({ ...item, quantity: 1 });
                }
                
                localStorage.setItem('almaNorteCart', JSON.stringify(cart));
                alert('Produto adicionado ao carrinho!');
            }
        }
        
        var favoritesOffcanvas = document.getElementById('favoritesOffcanvas');
        if (favoritesOffcanvas) {
            favoritesOffcanvas.addEventListener('show.bs.offcanvas', function () {
                renderFavoritesOffcanvas();
            });
        }
    </script>
</body>
</html>

